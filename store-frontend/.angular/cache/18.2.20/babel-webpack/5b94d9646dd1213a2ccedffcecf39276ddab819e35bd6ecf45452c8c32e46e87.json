{"ast":null,"code":"import { catchError } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nconst USER_URL = '/store/api/users';\nconst BASE_URL = '/store/api/auth';\nconst ORDER_URL = '/store/api/orders';\nexport let UserService = /*#__PURE__*/(() => {\n  class UserService {\n    //constructor\n    constructor(https) {\n      this.https = https;\n      this.logged = false;\n      this.reqIsLogged();\n    }\n    reqIsLogged() {\n      this.https.get(USER_URL + '/current', {\n        withCredentials: true\n      }).subscribe(response => {\n        this.user = response;\n        this.logged = true;\n      }, error => {\n        if (error.status === 401 || error.status === 403) {\n          this.logged = false;\n          this.user = undefined;\n        } else {\n          console.error('Unexpected error:', error);\n        }\n      });\n    }\n    signin(user, pass) {\n      this.https.post(BASE_URL + \"/login\", {\n        username: user,\n        password: pass\n      }, {\n        withCredentials: true\n      }).subscribe(_ => this.reqIsLogged(), _ => alert(\"Wrong credentials\"));\n    }\n    signout() {\n      return this.https.post(BASE_URL + '/logout', {\n        withCredentials: true\n      }).subscribe(_ => {\n        console.log(\"LOGOUT: succesfully\");\n        this.logged = false;\n        this.user = undefined;\n      });\n    }\n    isLogged() {\n      return this.logged;\n    }\n    isUser() {\n      //return this.user && this.user.rol.indexOf('USER') !== -1;\n      return this.user?.rol?.includes(\"USER\");\n    }\n    isAdmin() {\n      //return this.user && this.user.rol.indexOf('ADMIN') !== -1;\n      return this.user?.rol?.includes(\"ADMIN\");\n    }\n    //getUserImage(id: number | undefined){\n    //    return this.https.get(USER_URL + '/' + id + '/image');\n    //}\n    setUserImage(user, formData) {\n      return this.https.post(USER_URL + '/' + user.id + '/image', formData).pipe(catchError(error => {\n        return this.handleError(error);\n      }));\n    }\n    addUser(user) {\n      return this.https.post(USER_URL + '/new', user).pipe(catchError(error => {\n        return this.handleError(error);\n      }));\n    }\n    //getAdminImage(){\n    //    return this.https.get(USER_URL + '/6/image');\n    //}\n    setCurrentUser(user) {\n      this.user = user;\n    }\n    getCurrentUser() {\n      return this.user;\n    }\n    updateUser(id, user) {\n      return this.https.put(USER_URL + '/' + id + '/update', user).pipe(catchError(error => {\n        return this.handleError(error);\n      }));\n    }\n    getUserOrders(id, tam) {\n      return this.https.get(ORDER_URL + '/user/' + id + '?size=' + tam).pipe(catchError(error => {\n        return this.handleError(error);\n      }));\n    }\n    /*updateUserAddress(id: number, address:Direction){\n        return this.https.put(USER_URL + '/' + id + '/update/address', address).pipe(\n            catchError((error) => {\n                return this.handleError(error)\n            })\n        )as Observable<any>;\n    }*/\n    handleError(error) {\n      throw new Error(\"Method not implemented.\");\n    }\n    static {\n      this.ɵfac = function UserService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || UserService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: UserService,\n        factory: UserService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return UserService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}